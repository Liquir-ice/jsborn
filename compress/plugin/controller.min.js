JSB.extendPlugin(JSB.cls("jsborn.plugin.controller",{depends:["jsborn.core.model","jsborn.plugin.model"],getPrototype:function(){return{getRoot:this._get_root,registerClass:this._auto_class,registerData:this._auto_data,registerEvent:this._auto_event,select:this._select,setRoot:this._set_root}},initialize:function(){var a=this;a.PLUGIN_CONTROLLER={str_root:"body",tag:["INPUT","SELECT"],nodes:[]};a.addListener("destroy",function(){for(var b=0;b<a.PLUGIN_CONTROLLER.nodes.length;b++)a.PLUGIN_CONTROLLER.nodes[b].destroy()})},
_auto_data:function(){var a=this;this.select().find("[jsb-data]").filter(function(){return!$(this).parentsUntil(a.select(),"[jsb-cls]").length}).each(function(b,g){var c=jQuery(this),e=c.attr("jsb-data"),f=c.attr("jsb-data-event"),d=e.split(":"),e=d[0],k=d[1],h,d=a.PLUGIN_CONTROLLER;jQuery.isEmptyObject(f)&&(f="modify");h=-1==jQuery.inArray(c[0].tagName,d.tag)?"html":"val";a.getModel(e).addListener("model-"+f,function(a,b,d){a=JSB.core.model.getObjKey(d,k);c[h](a)})})},_auto_class:function(){var a=
this;this.select().find("[jsb-cls]").filter(function(){return!$(this).parentsUntil(a.select(),"[jsb-cls]").length}).each(function(b,g){var c=jQuery(this).attr("jsb-cls"),c=JSB.create(c);a.PLUGIN_CONTROLLER.nodes.push(c);jQuery(a).triggerHandler("cls.controller-create",[c,g])})},_auto_event:function(a){var b=this;this.select().find("[jsb-event]").filter(function(){return!$(this).parentsUntil(b.select(),"[jsb-cls]").length}).each(function(a,c){var e=jQuery(this).attr("jsb-event").split(":"),f=e[0],
d=b[e[1]];jQuery(this)[JSB.event.off](f)[JSB.event.on](f,{scope:b},function(b){jQuery.isFunction(d)?d.apply(this,arguments):console.log("DOM IS NOT DEFINE EVENT CallBack",a)})})},_select:function(){return jQuery(this.PLUGIN_CONTROLLER.str_root)},_set_root:function(a){this.PLUGIN_CONTROLLER.str_root=a;return this.PLUGIN_CONTROLLER.str_root},_get_root:function(){return this.PLUGIN_CONTROLLER.str_root}}));